
***************************************************************
*                 Welcome to use GPUMD                        *
*    (Graphics Processing Units Molecular Dynamics)           *
*                     version 4.2                             *
*              This is the nep executable                     *
***************************************************************


---------------------------------------------------------------
GPU information:
---------------------------------------------------------------

number of GPUs = 2
Device id:                   0
    Device name:             NVIDIA GeForce RTX 3090
    Compute capability:      8.6
    Amount of global memory: 23.6843 GB
    Number of SMs:           82
Device id:                   1
    Device name:             NVIDIA GeForce RTX 3090
    Compute capability:      8.6
    Amount of global memory: 23.6843 GB
    Number of SMs:           82
GPU-0 cannot access GPU-1.
GPU-1 cannot access GPU-0.

---------------------------------------------------------------
Started running nep.
---------------------------------------------------------------


---------------------------------------------------------------
Started reading nep.in.
---------------------------------------------------------------

Input or default parameters:
    (default) model_type = potential.
    (default) calculation mode = train.
    (input)   use NEP version 4.
    (input)   number of atom types = 1.
        (default) type 0 (C with Z = 6) has force weight of 1.
    (input)   will add the universal ZBL potential with outer cutoff 2 A and inner cutoff 1 A.
    (input)   radial cutoff = 6 A.
    (input)   angular cutoff = 5 A.
    (default) use global cutoff for NEP.
    (default) use global cutoff for ZBL.
    (input)   n_max_radial = 4.
    (input)   n_max_angular = 4.
    (input)   basis_size_radial = 8.
    (input)   basis_size_angular = 8.
    (input)   l_max_3body = 4.
    (input)   l_max_4body = 2.
    (input)   l_max_5body = 1.
    (input)   number of neurons = 80.
    (input)   lambda_1 = 0.
    (default) lambda_2 = 0.0552359.
    (input)   lambda_e = 1.
    (input)   lambda_f = 1.
    (input)   lambda_v = 1.
    (default) atomic_v = 0.
    (default) lambda_shear = 1.
    (default) force_delta = 0.
    (input)   batch size = 5000.
    (input)   population size = 50.
    (input)   maximum number of generations = 5000.
    (input)   save potential every N = 100000 generations.
    (input)   will fine-tune based on nep89_20250409.txt and nep89_20250409.restart.
Some calculated parameters:
    number of radial descriptor components = 5.
    number of angular descriptor components = 30.
    total number of descriptor components = 35.
    NN architecture = 35-80-1.
    number of NN parameters to be optimized = 2961.
    number of descriptor parameters to be optimized = 90.
    total number of parameters to be optimized = 3051.

---------------------------------------------------------------
Finished reading nep.in.
---------------------------------------------------------------


---------------------------------------------------------------
Started reading train.xyz
---------------------------------------------------------------

Number of configurations = 100.
Number of devices = 2
Number of batches = 1
Hello, I changed the batch_size from 5000 to 100.

Batch 0:
Number of configurations = 100.

---------------------------------------------------------------
Constructing train_set in device  0.
Total number of atoms = 9200.
Number of atoms in the largest configuration = 92.
Number of configurations having virial = 100.
Radial descriptor with a cutoff of 6 A:
    Minimum number of neighbors for one atom = 39.
    Maximum number of neighbors for one atom = 44.
Angular descriptor with a cutoff of 5 A:
    Minimum number of neighbors for one atom = 28.
    Maximum number of neighbors for one atom = 34.
---------------------------------------------------------------


---------------------------------------------------------------
Constructing train_set in device  1.
Total number of atoms = 9200.
Number of atoms in the largest configuration = 92.
Number of configurations having virial = 100.
Radial descriptor with a cutoff of 6 A:
    Minimum number of neighbors for one atom = 39.
    Maximum number of neighbors for one atom = 44.
Angular descriptor with a cutoff of 5 A:
    Minimum number of neighbors for one atom = 28.
    Maximum number of neighbors for one atom = 34.
---------------------------------------------------------------


---------------------------------------------------------------
Time used for initialization = 0.527298 s.
---------------------------------------------------------------


---------------------------------------------------------------
Started training.
---------------------------------------------------------------

Step    Total-Loss L1Reg-Loss L2Reg-Loss RMSE-E-Train RMSE-F-Train RMSE-V-Train RMSE-E-Test  RMSE-F-Test  RMSE-V-Test  
100     0.43427    0.00000    0.08424    0.00282      0.32938      0.01783      0.00000      0.00000      0.00000      
200     0.37085    0.00000    0.08432    0.00295      0.26771      0.01587      0.00000      0.00000      0.00000      
300     0.32716    0.00000    0.08448    0.00304      0.22432      0.01532      0.00000      0.00000      0.00000      
400     0.30247    0.00000    0.08460    0.00282      0.19972      0.01533      0.00000      0.00000      0.00000      
500     0.29193    0.00000    0.08473    0.00272      0.18909      0.01539      0.00000      0.00000      0.00000      
600     0.28599    0.00000    0.08480    0.00259      0.18325      0.01535      0.00000      0.00000      0.00000      
700     0.28151    0.00000    0.08490    0.00257      0.17896      0.01509      0.00000      0.00000      0.00000      
800     0.27829    0.00000    0.08495    0.00258      0.17598      0.01479      0.00000      0.00000      0.00000      
900     0.27575    0.00000    0.08501    0.00249      0.17370      0.01455      0.00000      0.00000      0.00000      
1000    0.27314    0.00000    0.08498    0.00243      0.17165      0.01409      0.00000      0.00000      0.00000      
1100    0.27076    0.00000    0.08502    0.00242      0.16959      0.01375      0.00000      0.00000      0.00000      
1200    0.26878    0.00000    0.08507    0.00232      0.16789      0.01350      0.00000      0.00000      0.00000      
1300    0.26706    0.00000    0.08510    0.00233      0.16643      0.01321      0.00000      0.00000      0.00000      
1400    0.26562    0.00000    0.08512    0.00226      0.16530      0.01294      0.00000      0.00000      0.00000      
1500    0.26393    0.00000    0.08513    0.00223      0.16375      0.01282      0.00000      0.00000      0.00000      
1600    0.26261    0.00000    0.08517    0.00221      0.16257      0.01266      0.00000      0.00000      0.00000      
1700    0.26160    0.00000    0.08519    0.00217      0.16195      0.01229      0.00000      0.00000      0.00000      
1800    0.26019    0.00000    0.08519    0.00218      0.16062      0.01221      0.00000      0.00000      0.00000      
1900    0.25898    0.00000    0.08521    0.00216      0.15963      0.01198      0.00000      0.00000      0.00000      
2000    0.25780    0.00000    0.08525    0.00212      0.15867      0.01176      0.00000      0.00000      0.00000      
2100    0.25663    0.00000    0.08525    0.00211      0.15768      0.01158      0.00000      0.00000      0.00000      
2200    0.25543    0.00000    0.08523    0.00209      0.15660      0.01151      0.00000      0.00000      0.00000      
2300    0.25452    0.00000    0.08520    0.00201      0.15591      0.01140      0.00000      0.00000      0.00000      
2400    0.25359    0.00000    0.08524    0.00206      0.15505      0.01123      0.00000      0.00000      0.00000      
2500    0.25262    0.00000    0.08522    0.00202      0.15429      0.01110      0.00000      0.00000      0.00000      
2600    0.25168    0.00000    0.08528    0.00195      0.15341      0.01103      0.00000      0.00000      0.00000      
2700    0.25076    0.00000    0.08529    0.00190      0.15277      0.01081      0.00000      0.00000      0.00000      
2800    0.25003    0.00000    0.08529    0.00188      0.15218      0.01068      0.00000      0.00000      0.00000      
2900    0.24935    0.00000    0.08532    0.00193      0.15149      0.01061      0.00000      0.00000      0.00000      
3000    0.24865    0.00000    0.08533    0.00192      0.15084      0.01055      0.00000      0.00000      0.00000      
3100    0.24798    0.00000    0.08529    0.00191      0.15025      0.01052      0.00000      0.00000      0.00000      
3200    0.24713    0.00000    0.08532    0.00187      0.14949      0.01044      0.00000      0.00000      0.00000      
3300    0.24637    0.00000    0.08537    0.00185      0.14884      0.01031      0.00000      0.00000      0.00000      
3400    0.24572    0.00000    0.08536    0.00181      0.14830      0.01025      0.00000      0.00000      0.00000      
3500    0.24492    0.00000    0.08537    0.00180      0.14759      0.01016      0.00000      0.00000      0.00000      
3600    0.24419    0.00000    0.08534    0.00180      0.14702      0.01003      0.00000      0.00000      0.00000      
3700    0.24356    0.00000    0.08530    0.00178      0.14655      0.00993      0.00000      0.00000      0.00000      
3800    0.24287    0.00000    0.08528    0.00174      0.14597      0.00987      0.00000      0.00000      0.00000      
3900    0.24237    0.00000    0.08524    0.00175      0.14551      0.00986      0.00000      0.00000      0.00000      
4000    0.24167    0.00000    0.08524    0.00173      0.14485      0.00985      0.00000      0.00000      0.00000      
4100    0.24106    0.00000    0.08531    0.00174      0.14424      0.00978      0.00000      0.00000      0.00000      
4200    0.24044    0.00000    0.08532    0.00172      0.14370      0.00969      0.00000      0.00000      0.00000      
4300    0.23986    0.00000    0.08538    0.00165      0.14326      0.00957      0.00000      0.00000      0.00000      
4400    0.23929    0.00000    0.08537    0.00160      0.14278      0.00954      0.00000      0.00000      0.00000      
4500    0.23865    0.00000    0.08538    0.00164      0.14211      0.00951      0.00000      0.00000      0.00000      
4600    0.23822    0.00000    0.08538    0.00166      0.14171      0.00947      0.00000      0.00000      0.00000      
4700    0.23778    0.00000    0.08535    0.00161      0.14143      0.00939      0.00000      0.00000      0.00000      
4800    0.23732    0.00000    0.08537    0.00161      0.14091      0.00943      0.00000      0.00000      0.00000      
4900    0.23670    0.00000    0.08538    0.00160      0.14038      0.00934      0.00000      0.00000      0.00000      
5000    0.23639    0.00000    0.08539    0.00160      0.14005      0.00935      0.00000      0.00000      0.00000      

---------------------------------------------------------------
Time used for training = 132.060137 s.
---------------------------------------------------------------


---------------------------------------------------------------
Finished running nep.
---------------------------------------------------------------

